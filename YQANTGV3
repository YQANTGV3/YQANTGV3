local allowedIDs = {
   [10449761463] = true,
}
if allowedIDs[game.PlaceId] then
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Welcome To YQANTG V3",
   Icon = 0,
   LoadingTitle = "YQANTG V3 Hub",
   LoadingSubtitle = "By YQANTG",
   ShowText = "Rayfield",
   Theme = "Dark", -- Check https://docs.sirius.menu/rayfield/configuration/themes

   ToggleUIKeybind = "K",

   DisableRayfieldPrompts = true,
   DisableBuildWarnings = true, 

   ConfigurationSaving = {
      Enabled = true,
      FolderName = YQANTG, -- Create a custom folder for your hub/game
      FileName = "Toggle"
   },

   Discord = {
      Enabled = true,
      Invite = "https://discord.gg/6UPwKTcC",
      RememberJoins = true
   },

   KeySystem = true,
   KeySettings = {
      Title = "Key",
      Subtitle = "Key System",
      Note = "Question: 1000 - 7 = ?",
      FileName = "key",
      SaveKey = false,
      GrabKeyFromSite = false,
      Key = {"993"}
   }
})

local Tab = Window:CreateTab("", "home")

local Section = Tab:CreateSection("Block")

local Button = Tab:CreateButton({
   Name = "Auto Block By Notpaki",
   Callback = function()
   loadstring(game:HttpGet("https://raw.githubusercontent.com/Cyborg883/TSB/refs/heads/main/CombatGui"))()
   end,
})

local Button = Tab:CreateButton({
   Name = "Auto Block By YQANTG",
   Callback = function()
   loadstring(game:HttpGet("https://raw.githubusercontent.com/Kietba/YQANTG-/refs/heads/main/AUTOBLOCKV2.lua.txt"))()
   end,
})

local Tab = Window:CreateTab("", "lock")

local Section = Tab:CreateSection("Aimbot")

local Button = Tab:CreateButton({
   Name = "Camera Aimbot",
   Callback = function()
   loadstring(game:HttpGet("https://raw.githubusercontent.com/Kietba/Kietba/refs/heads/main/Aimlock%20By%20YQANTG"))()
   end,
})

local Button = Tab:CreateButton({
   Name = "Slient Aim",
   Callback = function() 
loadstring(game:HttpGet("https://raw.githubusercontent.com/YQANTGV2/YQANTGV2/refs/heads/main/MMM"))()
   end,
})

local Button = Tab:CreateButton({
   Name = "Bot Follow + Slient Aim",
   Callback = function() 
loadstring(game:HttpGet("https://raw.githubusercontent.com/YQANTGV2/YQANTGV2/refs/heads/main/Bot"))()
   end,
})

local Button = Tab:CreateButton({
   Name = "Block Aim Near",
   Callback = function()
   loadstring(game:HttpGet("https://raw.githubusercontent.com/Kietba/Kietba/refs/heads/main/Block%20Aimlock"))()
   end,
})

local Tab = Window:CreateTab("", "bolt")

local Section = Tab:CreateSection("Local")

local Slider = Tab:CreateSlider({
   Name = "Fov",
   Range = {70, 300},
   Increment = 1,
   Suffix = "FOV",
   CurrentValue = 70,
   Flag = "FOVSlider",
   Callback = function(Value)
      workspace.CurrentCamera.FieldOfView = Value
   end,
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local lp = Players.LocalPlayer

local speedValue = 16
local speedLoop

local Slider = Tab:CreateSlider({
   Name = "Speed",
   Range = {10, 300},
   Increment = 1,
   Suffix = "Speed",
   CurrentValue = 16,
   Flag = "RunSpeedSlider",
   Callback = function(Value)
      speedValue = Value

      -- Bắt đầu loop nếu chưa có
      if not speedLoop then
         speedLoop = RunService.RenderStepped:Connect(function()
            local char = lp.Character
            local hum = char and char:FindFirstChildWhichIsA("Humanoid")
            if hum and hum.WalkSpeed ~= speedValue then
               hum.WalkSpeed = speedValue
            end
         end)
      end
   end,
})

local Players = game:GetService("Players")
local lp = Players.LocalPlayer

local enabled = false -- Trạng thái toggle
local animId = "rbxassetid://11365563255"

local Toggle = Tab:CreateToggle({
	Name = "Invisible Table Flip",
	CurrentValue = false,
	Flag = "AntiAnimToggle",
	Callback = function(Value)
		enabled = Value -- cập nhật trạng thái toggle
	end,
})

local Toggle = Tab:CreateToggle({
   Name = "Auto Respawn",
   CurrentValue = false,
   Flag = "ToggleRespawnAtDeathPos",
   Callback = function(Value)
      if Value then
         loadstring(game:HttpGet("https://raw.githubusercontent.com/YQANTGV2/YQANTGV2/refs/heads/main/L1(RP)"))()
      else
         loadstring(game:HttpGet("https://raw.githubusercontent.com/YQANTGV2/YQANTGV2/refs/heads/main/L2(RP)"))()
      end
   end,
})

local Toggle = Tab:CreateToggle({
   Name = "Auto Fake Out (Health < 35) Anti Player Get Ur Kill",
   CurrentValue = false,
   Flag = "ToggleFakeOut",
   Callback = function(Value)
      if Value then loadstring(game:HttpGet("https://raw.githubusercontent.com/YQANTGV2/YQANTGV2/refs/heads/main/L1(FO)"))()
      else loadstring(game:HttpGet("https://raw.githubusercontent.com/YQANTGV2/YQANTGV2/refs/heads/main/L2(FO)"))()
      end
   end,
})

local function handleAnimation(track, hrp, humanoid)
	if track.Animation and track.Animation.AnimationId == animId then
		if not enabled then return end

		track:Stop()
		task.wait()
		pcall(function() track:Destroy() end)

		local original = hrp.CFrame

		hrp.Anchored = true
		humanoid:ChangeState(Enum.HumanoidStateType.Physics)
		hrp.CFrame = original - Vector3.new(0, 5, 0)

		task.delay(4, function()
			if hrp and hrp.Parent then
				hrp.CFrame = original
				hrp.Anchored = false
				humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)
			end
		end)
	end
end

local function setup(char)
	local humanoid = char:WaitForChild("Humanoid")
	local hrp = char:WaitForChild("HumanoidRootPart")

	humanoid.AnimationPlayed:Connect(function(track)
		handleAnimation(track, hrp, humanoid)
	end)
end

-- Gắn vào nhân vật hiện tại và khi respawn
if lp.Character then
	setup(lp.Character)
end
lp.CharacterAdded:Connect(setup)

local player = game.Players.LocalPlayer
local targetAnimationId = "rbxassetid://10470389827"

local blockEnabled = false
local blockLoop = nil
local blockAnimConnection = nil
local respawnConnection = nil

-- Ngăn block animation đang chạy
local function stopBlockAnimations(humanoid)
	for _, track in ipairs(humanoid:GetPlayingAnimationTracks()) do
		if track.Animation and track.Animation.AnimationId == targetAnimationId then
			track:Stop()
			track:Destroy()
		end
	end
end

-- Bật block
local function enableBlock()
	local function setup(char)
		local hum = char:WaitForChild("Humanoid")

		if blockAnimConnection then blockAnimConnection:Disconnect() end
		if blockLoop then task.cancel(blockLoop) end

		-- Theo dõi animation bị phát
		blockAnimConnection = hum.AnimationPlayed:Connect(function(track)
			if track.Animation and track.Animation.AnimationId == targetAnimationId then
				track:Stop()
				track:Destroy()
			end
		end)

		-- Loop xoá liên tục nếu animation tái diễn
		blockLoop = task.spawn(function()
			while blockEnabled and hum.Parent do
				stopBlockAnimations(hum)
				task.wait(0.05)
			end
		end)
	end

	-- Gắn vào nhân vật hiện tại
	if player.Character then
		setup(player.Character)
	end

	-- Theo dõi khi respawn
	if respawnConnection then respawnConnection:Disconnect() end
	respawnConnection = player.CharacterAdded:Connect(function(char)
		if blockEnabled then
			setup(char)
		end
	end)
end

-- Tắt block
local function disableBlock()
	blockEnabled = false

	if blockAnimConnection then
		blockAnimConnection:Disconnect()
		blockAnimConnection = nil
	end
	if blockLoop then
		task.cancel(blockLoop)
		blockLoop = nil
	end
	if respawnConnection then
		respawnConnection:Disconnect()
		respawnConnection = nil
	end
end

local Toggle = Tab:CreateToggle({
	Name = "Invisible Block",
	CurrentValue = false,
	Flag = "InvisibleBlockToggle",
	Callback = function(Value)
		blockEnabled = Value
		if Value then
			enableBlock()
		else
			disableBlock()
		end
	end,
})

local player = game.Players.LocalPlayer
local runService = game:GetService("RunService")

local noStunConnection = nil

local function enableNoStun()
	if noStunConnection then return end

	noStunConnection = runService.RenderStepped:Connect(function()
		local char = player.Character
		if not char then return end

		-- Xóa trạng thái Stunned nếu có
		local stunned = char:FindFirstChild("Stunned")
		if stunned then
			stunned:Destroy()
		end

		-- Hủy PlatformStand và sửa WalkSpeed nếu bị khoá
		local hum = char:FindFirstChild("Humanoid")
		if hum then
			hum.PlatformStand = false
			if hum.WalkSpeed == 0 then
				hum.WalkSpeed = 20
			end
		end
	end)
end

local function disableNoStun()
	if noStunConnection then
		noStunConnection:Disconnect()
		noStunConnection = nil
	end
end

local Toggle = Tab:CreateToggle({
	Name = "No Stun",
	CurrentValue = false,
	Flag = "NoStunToggle",
	Callback = function(Value)
		if Value then
			enableNoStun()
		else
			disableNoStun()
		end
	end,
})

local player = game.Players.LocalPlayer
local runService = game:GetService("RunService")

local noSlowedConnection = nil

local function enableNoSlowed()
	if noSlowedConnection then return end
	noSlowedConnection = runService.RenderStepped:Connect(function()
		local char = player.Character
		if not char then return end
		local hum = char:FindFirstChild("Humanoid")
		if hum then
			if hum.WalkSpeed < 20 then
				hum.WalkSpeed = 22
			end
			hum.PlatformStand = false
		end
	end)
end

local function disableNoSlowed()
	if noSlowedConnection then
		noSlowedConnection:Disconnect()
		noSlowedConnection = nil
	end
end

local Toggle = Tab:CreateToggle({
	Name = "No Slowed",
	CurrentValue = false,
	Flag = "NoSlowedToggle",
	Callback = function(Value)
		if Value then
			enableNoSlowed()
		else
			disableNoSlowed()
		end
	end,
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local lp = Players.LocalPlayer

local blockedIds = {
	"12447707844",
	"12342141464",
	"12772543293"
}

local function isBlocked(animationId)
	for _, id in pairs(blockedIds) do
		if animationId:find(id) then
			return true
		end
	end
	return false
end

local Toggle = Tab:CreateToggle({
	Name = "No Anim Ult",
	CurrentValue = false,
	Flag = "NoAnimUltToggle",
	Callback = function(Value)
		if _G.BlockAnimConnection then
			_G.BlockAnimConnection:Disconnect()
			_G.BlockAnimConnection = nil
		end

		if Value then
			_G.BlockAnimConnection = RunService.Stepped:Connect(function()
				local char = lp.Character
				if not char then return end
				local humanoid = char:FindFirstChildOfClass("Humanoid")
				if humanoid then
					local animator = humanoid:FindFirstChildOfClass("Animator")
					if animator then
						for _, track in ipairs(animator:GetPlayingAnimationTracks()) do
							local anim = track.Animation
							if anim and isBlocked(anim.AnimationId) then
								track:Stop(0)
								pcall(function() track:Destroy() end)
							end
						end
					end
				end
			end)
		end
	end,
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local lp = Players.LocalPlayer
local cam = Workspace.CurrentCamera

local Toggle = Tab:CreateToggle({
	Name = "Free Rotate Ult Saitama",
	CurrentValue = false,
	Flag = "FaceCameraYToggle",
	Callback = function(Value)
		if _G.FaceCamConnection then
			_G.FaceCamConnection:Disconnect()
			_G.FaceCamConnection = nil
		end

		if Value then
			_G.FaceCamConnection = RunService.RenderStepped:Connect(function()
				local char = lp.Character
				if not char then return end
				local hrp = char:FindFirstChild("HumanoidRootPart")
				if not hrp then return end

				local camLook = cam.CFrame.LookVector
				local lookDir = Vector3.new(camLook.X, 0, camLook.Z).Unit

				hrp.CFrame = CFrame.new(hrp.Position, hrp.Position + lookDir)
			end)
		end
	end,
})

local Lighting = game:GetService("Lighting")
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local Camera = Workspace.CurrentCamera

local LocalPlayer = Players.LocalPlayer

local Toggle = Tab:CreateToggle({
	Name = "Ultra Shader",
	CurrentValue = false,
	Flag = "UltraShaderToggle",
	Callback = function(Value)
		local shaderOn = Value
		local bloom, sunrays, cc, sky, atmo
		local reflectionModel

		local motionBlur = Instance.new("BlurEffect")
		motionBlur.Name = "MotionBlur"
		motionBlur.Size = 5
		motionBlur.Parent = Lighting

		local lastLookVector = Camera.CFrame.LookVector

		local motionConnection = RunService.RenderStepped:Connect(function()
			if not shaderOn then motionConnection:Disconnect() return end
			local currentLook = Camera.CFrame.LookVector
			local delta = (currentLook - lastLookVector).Magnitude
			lastLookVector = currentLook

			local rightVector = Camera.CFrame.RightVector
			local angleOffset = math.abs(currentLook:Dot(rightVector))
			local blurAmount = math.clamp(angleOffset * delta * 800, 0, 40)

			motionBlur.Size = shaderOn and (blurAmount + 4) or blurAmount
		end)

		local function setupSky()
			sky = Instance.new("Sky", Lighting)
			sky.SkyboxBk = "rbxassetid://7115316513"
			sky.SkyboxDn = "rbxassetid://7115316904"
			sky.SkyboxFt = "rbxassetid://7115317252"
			sky.SkyboxLf = "rbxassetid://7115317606"
			sky.SkyboxRt = "rbxassetid://7115317973"
			sky.SkyboxUp = "rbxassetid://7115318319"
			sky.SunAngularSize = 21
			sky.MoonAngularSize = 11
			sky.StarCount = 3000
		end

		local function applyShader()
			Lighting.ClockTime = 12
			Lighting.Brightness = 3
			Lighting.GlobalShadows = true
			Lighting.OutdoorAmbient = Color3.fromRGB(135, 148, 178)
			Lighting.FogEnd = 800
			Lighting.FogStart = 0
			Lighting.FogColor = Color3.fromRGB(200, 220, 250)

			setupSky()

			bloom = Instance.new("BloomEffect", Lighting)
			bloom.Intensity = 2.6
			bloom.Size = 100
			bloom.Threshold = 1

			sunrays = Instance.new("SunRaysEffect", Lighting)
			sunrays.Intensity = 0.55
			sunrays.Spread = 2.2

			cc = Instance.new("ColorCorrectionEffect", Lighting)
			cc.Brightness = 0.18
			cc.Contrast = 0.2
			cc.Saturation = 0.3
			cc.TintColor = Color3.fromRGB(255, 230, 180)

			atmo = Instance.new("Atmosphere", Lighting)
			atmo.Density = 0.30
			atmo.Offset = 0.8
			atmo.Glare = 0.3
			atmo.Haze = 1.5
			atmo.Color = Color3.fromRGB(200, 220, 255)
			atmo.Decay = Color3.fromRGB(180, 190, 290)

			local sun = Instance.new("Part")
			sun.Name = "FakeSun"
			sun.Size = Vector3.new(15, 15, 15)
			sun.Shape = Enum.PartType.Ball
			sun.Anchored = true
			sun.CanCollide = true
			sun.Material = Enum.Material.Neon
			sun.Color = Color3.fromRGB(255, 240, 180)
			sun.Position = Camera.CFrame.Position + Vector3.new(0, 300, 500)
			sun.Parent = workspace

			local light = Instance.new("SurfaceLight", sun)
			light.Brightness = 3
			light.Range = 100
			light.Angle = 180
			light.Face = Enum.NormalId.Top
			light.Color = Color3.fromRGB(255, 220, 150)

			local beam = Instance.new("ParticleEmitter", sun)
			beam.LightEmission = 10
			beam.LightInfluence = 10
			beam.Texture = "rbxassetid://259703948"
			beam.Size = NumberSequence.new({NumberSequenceKeypoint.new(0, 6), NumberSequenceKeypoint.new(1, 0)})
			beam.Transparency = NumberSequence.new(0.1)
			beam.Rate = 100
			beam.Speed = NumberRange.new(0)
			beam.Lifetime = NumberRange.new(1)
			beam.Color = ColorSequence.new(Color3.fromRGB(255, 220, 150))

			local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
			reflectionModel = character:Clone()
			reflectionModel.Name = "Reflection"
			reflectionModel.Parent = workspace

			for _, part in ipairs(reflectionModel:GetDescendants()) do
				if part:IsA("BasePart") then
					part.Anchored = true
					part.CanCollide = false
					part.Material = Enum.Material.SmoothPlastic
					part.Transparency = 0.4
				end
			end

			task.spawn(function()
				while shaderOn and reflectionModel and reflectionModel.Parent do
					local root = character:FindFirstChild("HumanoidRootPart")
					local refRoot = reflectionModel:FindFirstChild("HumanoidRootPart")
					if root and refRoot then
						reflectionModel:SetPrimaryPartCFrame(CFrame.new(Vector3.new(root.Position.X, -root.Position.Y + 1, root.Position.Z)) * CFrame.Angles(math.rad(180), 0, 0))
					end
					task.wait(0.03)
				end
			end)
		end

		local function removeShader()
			Lighting.ClockTime = 12
			Lighting.Brightness = 1.2
			Lighting.FogEnd = 100000
			Lighting.GlobalShadows = true
			Lighting.OutdoorAmbient = Color3.fromRGB(128, 118, 148)

			for _, v in pairs(Lighting:GetChildren()) do
				if v:IsA("BloomEffect") or v:IsA("SunRaysEffect") or v:IsA("ColorCorrectionEffect")
				or v:IsA("Sky") or v:IsA("Atmosphere") or v.Name == "MotionBlur" then
					v:Destroy()
				end
			end

			if workspace:FindFirstChild("FakeSun") then
				workspace.FakeSun:Destroy()
			end
			if reflectionModel then
				reflectionModel:Destroy()
			end
		end

		if shaderOn then
			applyShader()
		else
			removeShader()
		end
	end,
})

local Tab = Window:CreateTab("", "cloud")

local Section = Tab:CreateSection("Other")

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local lp = Players.LocalPlayer

_G.BodyOrbitConnection = nil

local Input = Tab:CreateInput({
   Name = "Orbit",
   CurrentValue = "",
   PlaceholderText = "Name",
   RemoveTextAfterFocusLost = false,
   Flag = "BoyTooOrbitInput",
   Callback = function(text)
      if _G.BodyOrbitConnection then
         _G.BodyOrbitConnection:Disconnect()
         _G.BodyOrbitConnection = nil
      end

      local function findTarget(input)
         input = input:lower()
         for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= lp then
               local name = plr.Name:lower()
               local display = (plr.DisplayName or ""):lower()
               if name:find(input) == 1 or display:find(input) == 1 then
                  return plr
               end
            end
         end
         return nil
      end

      local target = findTarget(text)
      if not target then return end

      _G.BodyOrbitConnection = RunService.RenderStepped:Connect(function()
         local targetHRP = target.Character and target.Character:FindFirstChild("HumanoidRootPart")
         local myHRP = lp.Character and lp.Character:FindFirstChild("HumanoidRootPart")

         if targetHRP and myHRP then
            local t = tick() * 7 -- tốc độ quay
            local radius = 5
            local offset = Vector3.new(math.cos(t) * radius, 0, math.sin(t) * radius)
            local newPos = targetHRP.Position + offset
            myHRP.CFrame = CFrame.new(newPos, targetHRP.Position)
         end
      end)
   end,
})

local Button = Tab:CreateButton({
   Name = "Stop Orbit",
   Callback = function()
      if _G.BodyOrbitConnection then
         _G.BodyOrbitConnection:Disconnect()
         _G.BodyOrbitConnection = nil
      end
   end,
})

local Button = Tab:CreateButton({
   Name = "Orbit Gui",
   Callback = function()
   loadstring(game:HttpGet("https://raw.githubusercontent.com/Kietba/Kietba/refs/heads/main/Orbit%20by%20YQANTG"))()
   end,
})

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local lp = Players.LocalPlayer
local cam = workspace.CurrentCamera
local gui = lp:WaitForChild("PlayerGui")

-- Tìm nút PunchButton
local jumpBtn = gui:FindFirstChild("JumpButton", true)
local punchBtn = jumpBtn and jumpBtn:FindFirstChild("PunchButton")

-- Biến trạng thái toggle
local tweenEnabled = false
local holding = false
local looping = false

-- 🔍 Tìm mục tiêu gần nhất trong 50 studs
local function getClosestTarget()
	local live = workspace:FindFirstChild("Live")
	if not live then return end

	local closest, shortest = nil, 50
	for _, model in ipairs(live:GetChildren()) do
		if model:IsA("Model") and model ~= lp.Character and model:FindFirstChild("HumanoidRootPart") and model:FindFirstChild("Humanoid") then
			if model.Humanoid.Health > 0 then
				local dist = (lp.Character.HumanoidRootPart.Position - model.HumanoidRootPart.Position).Magnitude
				if dist <= shortest then
					shortest = dist
					closest = model
				end
			end
		end
	end
	return closest
end

-- Tween đến mục tiêu
local function dashToTarget(target)
	local hrp = lp.Character and lp.Character:FindFirstChild("HumanoidRootPart")
	if not hrp or not target then return end

	local pos = target:FindFirstChild("HumanoidRootPart") and target.HumanoidRootPart.Position
	if not pos then return end

	local dir = (pos - hrp.Position).Unit
	local dest = pos - dir * 2

	local tween = TweenService:Create(hrp, TweenInfo.new(0.15, Enum.EasingStyle.Linear), {
		CFrame = CFrame.new(dest)
	})
	tween:Play()
end

-- Bắt đầu khi giữ PunchButton
local function startLoop()
	if looping then return end
	looping = true
	while holding do
		if not tweenEnabled then break end
		local target = getClosestTarget()
		if target then
			dashToTarget(target)
		end
		task.wait(0.15)
	end
	looping = false
end

-- Gắn sự kiện cho PunchButton
if punchBtn then
	punchBtn.MouseButton1Down:Connect(function()
		if not tweenEnabled then return end
		holding = true
		startLoop()
	end)

	punchBtn.MouseButton1Up:Connect(function()
		holding = false
	end)
else
	warn("❌ Không tìm thấy PunchButton!")
end

-- ✅ Tạo Toggle (dạng chuẩn)
local Toggle = Tab:CreateToggle({
	Name = "M1 Reach",
	CurrentValue = false,
	Flag = "TweenReachToggle",
	Callback = function(Value)
		tweenEnabled = Value
	end,
})

local player = game.Players.LocalPlayer
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

-- GUI: Cooldown bar
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.Name = "StickGui"
screenGui.ResetOnSpawn = false -- ✅ giữ lại GUI sau khi chết

local cooldownFrame = Instance.new("Frame", screenGui)
cooldownFrame.Size = UDim2.new(0, 240, 0, 25)
cooldownFrame.Position = UDim2.new(0.5, -130, 0.6, 0)
cooldownFrame.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
cooldownFrame.BackgroundTransparency = 0.2
cooldownFrame.Visible = false
Instance.new("UICorner", cooldownFrame).CornerRadius = UDim.new(0, 8)

local loadingBar = Instance.new("Frame", cooldownFrame)
loadingBar.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
loadingBar.Size = UDim2.new(0, 0, 1, 0)
loadingBar.Position = UDim2.new(0, 0, 0, 0)
Instance.new("UICorner", loadingBar).CornerRadius = UDim.new(0, 8)

local cooldownText = Instance.new("TextLabel", cooldownFrame)
cooldownText.BackgroundTransparency = 1
cooldownText.Size = UDim2.new(1, 0, 1, 0)
cooldownText.TextColor3 = Color3.new(1, 1, 1)
cooldownText.Font = Enum.Font.GothamSemibold
cooldownText.TextScaled = true
cooldownText.Text = ""

-- Biến
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local autoEnabled = false
local autoBurrowRunning = false
local animationConnection = nil
local spamThread = nil
local noclipConnection = nil
local isCooldown = false

-- Danh sách animation Burrow
local burrowAnimations = {
	"10469643643", "10469639222", "13532604085", "13294471966", "13295919399", "13295936866",
	"13378751717", "13378708199", "14001963401", "14136436157", "15240176873", "15162694192",
	"16515448089", "16552234590", "17889471098", "17889290569", "104895379416342", "134775406437626"
}

-- Animation cần dùng remote
local triggerRemoteAnimations = {
	["rbxassetid://10469639222"] = true,
	["rbxassetid://13532604085"] = true,
	["rbxassetid://13295919399"] = true,
	["rbxassetid://13378751717"] = true,
	["rbxassetid://14001963401"] = true,
	["rbxassetid://15240176873"] = true,
	["rbxassetid://16515448089"] = true,
	["rbxassetid://17889471098"] = true,
	["rbxassetid://104895379416342"] = true
}

local function isBurrowAnimation(animID)
	return table.find(burrowAnimations, animID:gsub("rbxassetid://", "")) ~= nil
end

local function enableNoclip(char)
	noclipConnection = RunService.Stepped:Connect(function()
		for _, part in ipairs(char:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
			end
		end
	end)
end

local function disableNoclip(char)
	if noclipConnection then
		noclipConnection:Disconnect()
		noclipConnection = nil
	end
	for _, part in ipairs(char:GetDescendants()) do
		if part:IsA("BasePart") then
			part.CanCollide = true
		end
	end
end

local function holdY(hrp, y)
	return RunService.RenderStepped:Connect(function()
		local pos = hrp.Position
		hrp.Velocity = Vector3.zero
		hrp.AssemblyLinearVelocity = Vector3.zero
		hrp.CFrame = CFrame.new(Vector3.new(pos.X, y, pos.Z), pos + hrp.CFrame.LookVector)
	end)
end

local function getNearbyTargets(char, radius)
	local hrp = char:FindFirstChild("HumanoidRootPart")
	if not hrp then return {} end
	local targets = {}
	for _, obj in pairs(workspace:GetDescendants()) do
		if obj:IsA("Model") and obj ~= char and obj:FindFirstChild("HumanoidRootPart") and obj:FindFirstChildOfClass("Humanoid") then
			if (obj.HumanoidRootPart.Position - hrp.Position).Magnitude <= radius then
				table.insert(targets, obj)
			end
		end
	end
	return targets
end

local function startSpam()
	if spamThread then task.cancel(spamThread) end
	spamThread = task.spawn(function()
		while autoEnabled do
			pcall(function()
				if player.Character and player.Character:FindFirstChild("Communicate") then
					player.Character.Communicate:FireServer({ Goal = "Wall Combo" })
				end
			end)
			task.wait(0.05)
		end
	end)
end

local function startCooldown()
	isCooldown = true
	cooldownFrame.Visible = true
	loadingBar.Size = UDim2.new(0, 0, 1, 0)
	cooldownText.Text = "Cooldown: 15s"

	local tween = TweenService:Create(loadingBar, TweenInfo.new(15, Enum.EasingStyle.Linear), {
		Size = UDim2.new(1, 0, 1, 0)
	})
	tween:Play()

	for i = 10, 0, -1 do
		cooldownText.Text = "Wallcombo: " .. i .. "s"
		task.wait(1)
	end

	cooldownFrame.Visible = false
	cooldownText.Text = ""
	loadingBar.Size = UDim2.new(0, 0, 1, 0)
	isCooldown = false
end

local function burrowUnderTarget(char, target)
	if isCooldown then return end
	isCooldown = true

	local hrp = char:FindFirstChild("HumanoidRootPart")
	local hum = char:FindFirstChildOfClass("Humanoid")
	local tHrp = target:FindFirstChild("HumanoidRootPart")
	if not hrp or not hum or not tHrp then isCooldown = false return end

	hum.PlatformStand = false
	hum.Sit = false
	enableNoclip(char)

	local cam = workspace.CurrentCamera
	local oldCamType = cam.CameraType
	cam.CameraType = Enum.CameraType.Scriptable

	local y = tHrp.Position.Y - 4.2
	hrp.CFrame = CFrame.new(Vector3.new(tHrp.Position.X, y, tHrp.Position.Z))

	local holdConn = holdY(hrp, y)
	task.delay(0.28, function()
		cam.CameraType = oldCamType
	end)

	task.wait(0.28)
	if holdConn then holdConn:Disconnect() end
	disableNoclip(char)
	task.delay(3, function()
		startCooldown()
	end)
end

function connectAnimationWatcher()
	if animationConnection then animationConnection:Disconnect() end
	local hum = character:WaitForChild("Humanoid")
	local hrp = character:WaitForChild("HumanoidRootPart")

	animationConnection = hum.AnimationPlayed:Connect(function(track)
		local animID = tostring(track.Animation.AnimationId)

		if triggerRemoteAnimations[animID] and autoEnabled and not isCooldown then
			task.delay(0.2, function()
				pcall(function()
					character.Communicate:FireServer({ Mobile = true, Goal = "LeftClick" })
				end)
			end)
			task.delay(0.5, function()
				pcall(function()
					character.Communicate:FireServer({ Goal = "LeftClickRelease", Mobile = true })
				end)
			end)
		end

		if isBurrowAnimation(animID) and not autoBurrowRunning and autoEnabled then
			autoBurrowRunning = true
			task.delay(0.15, function()
				local targets = getNearbyTargets(character, 10)
				local closest, dist = nil, math.huge
				for _, t in ipairs(targets) do
					local d = (t.HumanoidRootPart.Position - hrp.Position).Magnitude
					if d < dist then
						closest = t
						dist = d
					end
				end
				if closest then burrowUnderTarget(character, closest) end
				autoBurrowRunning = false
			end)
		end
	end)
end

-- Gắn lại sau khi chết
player.CharacterAdded:Connect(function(char)
	character = char
	humanoidRootPart = character:WaitForChild("HumanoidRootPart")
	connectAnimationWatcher()
	if autoEnabled then startSpam() end
end)

-- Lần đầu
connectAnimationWatcher()

-- Gắn Toggle
local Toggle = Tab:CreateToggle({
   Name = "Auto WallCombo + AnyWhere",
   CurrentValue = false,
   Flag = "AutoWallComboBurrow",
   Callback = function(Value)
       autoEnabled = Value
       if autoEnabled then
           startSpam()
       else
           if spamThread then
               task.cancel(spamThread)
               spamThread = nil
           end
       end
   end,
})

-- Character handler
local function onCharacterAdded(char)
	character = char
	humanoidRootPart = char:WaitForChild("HumanoidRootPart")
	connectAnimationWatcher()
	if autoEnabled then startSpam() end
end

connectAnimationWatcher()
player.CharacterAdded:Connect(onCharacterAdded)
if autoEnabled then startSpam() end

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HRP = Character:WaitForChild("HumanoidRootPart")
local Communicate = Character:WaitForChild("Communicate")
local Live = workspace:WaitForChild("Live")

local Toggle = Tab:CreateToggle({
   Name = "Auto Counter Skill + M1",
   CurrentValue = false,
   Flag = "AutoReactToggle",
   Callback = function(state)
      _G.AutoReact = state
   end,
})

local delayed = {
   ["rbxassetid://10479335397"] = true,
   ["rbxassetid://13380255751"] = true,
   ["rbxassetid://134775406437626"] = true,
}

local normal = {
   ["rbxassetid://10469493270"] = true, ["rbxassetid://10469630950"] = true, ["rbxassetid://10469639222"] = true,
   ["rbxassetid://10469643643"] = true, ["rbxassetid://13532562418"] = true, ["rbxassetid://13532600125"] = true,
   ["rbxassetid://13532604085"] = true, ["rbxassetid://13294471966"] = true, ["rbxassetid://13491635433"] = true,
   ["rbxassetid://13296577783"] = true, ["rbxassetid://13295919399"] = true, ["rbxassetid://13295936866"] = true,
   ["rbxassetid://13370310513"] = true, ["rbxassetid://13390230973"] = true, ["rbxassetid://13378751717"] = true,
   ["rbxassetid://13378708199"] = true, ["rbxassetid://14004222985"] = true, ["rbxassetid://13997092940"] = true,
   ["rbxassetid://14001963401"] = true, ["rbxassetid://14136436157"] = true, ["rbxassetid://15259161390"] = true,
   ["rbxassetid://15240216931"] = true, ["rbxassetid://15240176873"] = true, ["rbxassetid://15162694192"] = true,
   ["rbxassetid://16515503507"] = true, ["rbxassetid://16515520431"] = true, ["rbxassetid://16515448089"] = true,
   ["rbxassetid://16552234590"] = true, ["rbxassetid://17889458563"] = true, ["rbxassetid://17889461810"] = true,
   ["rbxassetid://17889471098"] = true, ["rbxassetid://17889290569"] = true, ["rbxassetid://123005629431309"] = true,
   ["rbxassetid://100059874351664"] = true, ["rbxassetid://104895379416342"] = true,
}

local more = {
   ["rbxassetid://10468665991"] = true, ["rbxassetid://10466974800"] = true, ["rbxassetid://10471336737"] = true,
   ["rbxassetid://12510170988"] = true, ["rbxassetid://12272894215"] = true, ["rbxassetid://12296882427"] = true,
   ["rbxassetid://12307656616"] = true, ["rbxassetid://101588604872680"] = true, ["rbxassetid://105442749844047"] = true,
   ["rbxassetid://109617620932970"] = true, ["rbxassetid://131820095363270"] = true, ["rbxassetid://135289891173395"] = true,
   ["rbxassetid://125955606488863"] = true, ["rbxassetid://12534735382"] = true, ["rbxassetid://12502664044"] = true,
   ["rbxassetid://12509505723"] = true, ["rbxassetid://12618271998"] = true, ["rbxassetid://12684390285"] = true,
   ["rbxassetid://13376869471"] = true, ["rbxassetid://13294790250"] = true, ["rbxassetid://13376962659"] = true,
   ["rbxassetid://13501296372"] = true, ["rbxassetid://13556985475"] = true, ["rbxassetid://145162735010"] = true,
   ["rbxassetid://14046756619"] = true, ["rbxassetid://14299135500"] = true, ["rbxassetid://14351441234"] = true,
   ["rbxassetid://15290930205"] = true, ["rbxassetid://15145462680"] = true, ["rbxassetid://15295895753"] = true,
   ["rbxassetid://15295336270"] = true, ["rbxassetid://16139108718"] = true, ["rbxassetid://16515850153"] = true,
   ["rbxassetid://16431491215"] = true, ["rbxassetid://16597322398"] = true, ["rbxassetid://16597912086"] = true,
   ["rbxassetid://17799224866"] = true, ["rbxassetid://17838006839"] = true, ["rbxassetid://17857788598"] = true,
   ["rbxassetid://18179181663"] = true, ["rbxassetid://113166426814229"] = true, ["rbxassetid://116753755471636"] = true,
   ["rbxassetid://116153572280464"] = true, ["rbxassetid://114095570398448"] = true, ["rbxassetid://77509627104305"] = true,
}

for id in pairs(more) do
   normal[id] = true
end

local activated = {}

local function closeEnough(a, b, dist)
   return (a - b).Magnitude <= dist
end

local function fire()
   local prey = LocalPlayer.Backpack:FindFirstChild("Prey's Peril")
   if prey then Communicate:FireServer({ Tool = prey, Goal = "Console Move" }) end

   local split = LocalPlayer.Backpack:FindFirstChild("Split Second Counter")
   if split then Communicate:FireServer({ Tool = split, Goal = "Console Move" }) end
end

RunService.Heartbeat:Connect(function()
   if not _G.AutoReact then return end

   for _, model in pairs(Live:GetChildren()) do
      if model:IsA("Model") and model ~= Character and model:FindFirstChild("HumanoidRootPart") then
         local hum = model:FindFirstChildOfClass("Humanoid")
         local anim = hum and hum:FindFirstChildOfClass("Animator")
         if anim then
            for _, track in pairs(anim:GetPlayingAnimationTracks()) do
               local id = track.Animation.AnimationId
               local key = model:GetDebugId() .. id
               local dist = (delayed[id] and 13) or 13
task.wait(0.0001)
               if (delayed[id] or normal[id]) and closeEnough(HRP.Position, model.HumanoidRootPart.Position, dist) then
                  if not activated[key] then
                     activated[key] = true
                     if delayed[id] then
                        task.delay(0.0001, fire)
                     else
                        fire()
                     end
                  end
               else
                  activated[key] = nil
               end
            end
         end
      end
   end
end)

local Tab = Window:CreateTab("", "search")

local Section = Tab:CreateSection("Esp Player")

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local espFolder = Instance.new("Folder")
espFolder.Name = "ESP_DisplayNames"
espFolder.Parent = game.CoreGui

local function createESP(player)
	if player == Players.LocalPlayer then return end
	if espFolder:FindFirstChild(player.Name) then return end

	local billboard = Instance.new("BillboardGui")
	billboard.Name = player.Name
	billboard.Size = UDim2.new(0, 100, 0, 20)
	billboard.StudsOffset = Vector3.new(0, 3, 0)
	billboard.AlwaysOnTop = true

	local nameLabel = Instance.new("TextLabel")
	nameLabel.Size = UDim2.new(1, 0, 1, 0)
	nameLabel.BackgroundTransparency = 1
	nameLabel.TextColor3 = Color3.fromRGB(0, 255, 0) -- xanh lục
	nameLabel.TextStrokeTransparency = 0.4
	nameLabel.Text = player.DisplayName or "Unknown"
	nameLabel.Font = Enum.Font.SourceSansBold
	nameLabel.TextScaled = false
	nameLabel.TextSize = 14
	nameLabel.Parent = billboard

	billboard.Parent = espFolder

	local function update()
		local char = player.Character
		if char and char:FindFirstChild("Head") then
			billboard.Adornee = char.Head
			nameLabel.Text = player.DisplayName
			billboard.Enabled = true
		else
			billboard.Enabled = false
		end
	end

	local conn = RunService.RenderStepped:Connect(update)

	player.AncestryChanged:Connect(function(_, parent)
		if not parent then
			if conn then conn:Disconnect() end
			billboard:Destroy()
		end
	end)
end

local function removeESP(player)
	local gui = espFolder:FindFirstChild(player.Name)
	if gui then gui:Destroy() end
end

local function enableESP()
	for _, plr in pairs(Players:GetPlayers()) do
		createESP(plr)
	end
	Players.PlayerAdded:Connect(createESP)
	Players.PlayerRemoving:Connect(removeESP)
end

local function disableESP()
	for _, v in pairs(espFolder:GetChildren()) do
		v:Destroy()
	end
end

local Toggle = Tab:CreateToggle({
	Name = "Name",
	CurrentValue = false,
	Flag = "ESPDisplayNameToggle",
	Callback = function(Value)
		if Value then
			enableESP()
		else
			disableESP()
		end
	end,
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local hlFolder = Instance.new("Folder")
hlFolder.Name = "ESP_Highlights"
hlFolder.Parent = game.CoreGui

local function createHighlight(player)
	if player == Players.LocalPlayer then return end
	if hlFolder:FindFirstChild(player.Name .. "_HL") then return end

	local highlight = Instance.new("Highlight")
	highlight.Name = player.Name .. "_HL"
	highlight.FillTransparency = 1
	highlight.OutlineTransparency = 0.2
	highlight.OutlineColor = Color3.fromRGB(0, 255, 0)
	highlight.Parent = hlFolder

	local function update()
		local char = player.Character
		if char then
			highlight.Adornee = char
			highlight.Enabled = true
		else
			highlight.Enabled = false
		end
	end

	local conn = RunService.RenderStepped:Connect(update)

	player.AncestryChanged:Connect(function(_, parent)
		if not parent then
			if conn then conn:Disconnect() end
			highlight:Destroy()
		end
	end)
end

local function removeHighlight(player)
	local hl = hlFolder:FindFirstChild(player.Name .. "_HL")
	if hl then hl:Destroy() end
end

local function enableHighlight()
	for _, plr in pairs(Players:GetPlayers()) do
		createHighlight(plr)
	end
	Players.PlayerAdded:Connect(createHighlight)
	Players.PlayerRemoving:Connect(removeHighlight)
end

local function disableHighlight()
	for _, v in pairs(hlFolder:GetChildren()) do
		v:Destroy()
	end
end

local ToggleHighlight = Tab:CreateToggle({
	Name = "Highlight",
	CurrentValue = false,
	Flag = "ESP_Highlight",
	Callback = function(Value)
		if Value then
			enableHighlight()
		else
			disableHighlight()
		end
	end,
})

local Tab = Window:CreateTab("", "gamepad")

local Section = Tab:CreateSection("Auto Tech And More")

local Button = Tab:CreateButton({
   Name = "All in one ( Click Me )",
   Callback = function()
   loadstring(game:HttpGet("https://raw.githubusercontent.com/YQANTG/YQANTG/refs/heads/main/alltechsceiot.txt"))()
   end,
})

local Tab = Window:CreateTab("", "folder")

local Section = Tab:CreateSection("Auto Farm")

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

local keyCodes = { Enum.KeyCode.One, Enum.KeyCode.Two, Enum.KeyCode.Three, Enum.KeyCode.Four }

local stickOn = false
local target, connection, spamConnection, velocity, gyro
local noclipConnection
local oldCFrame
local oldCameraType

-- Noclip
local function enableNoclip()
	local char = player.Character
	if not char then return end
	noclipConnection = RunService.Stepped:Connect(function()
		for _, part in ipairs(char:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
			end
		end
	end)
end

local function disableNoclip()
	if noclipConnection then
		noclipConnection:Disconnect()
		noclipConnection = nil
	end
	local char = player.Character
	if char then
		for _, part in ipairs(char:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = true
			end
		end
	end
end

-- Tìm player gần nhất
local function findClosestPlayer()
	local char = player.Character
	if not char then return end
	local hrp = char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end

	local closest = nil
	local shortest = math.huge
	for _, p in pairs(Players:GetPlayers()) do
		if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") and p.Character:FindFirstChild("Humanoid") then
			local dist = (p.Character.HumanoidRootPart.Position - hrp.Position).Magnitude
			if dist < 10000 and p.Character.Humanoid.Health > 0 and dist < shortest then
				shortest = dist
				closest = p
			end
		end
	end
	return closest
end

-- Spam key + remote
local function startSpamming()
	local char = player.Character
	if not char then return end
	spamConnection = RunService.Heartbeat:Connect(function()
		for _, key in ipairs(keyCodes) do
			VirtualInputManager:SendKeyEvent(true, key, false, game)
			task.wait(0.01)
			VirtualInputManager:SendKeyEvent(false, key, false, game)
		end

		char:WaitForChild("Communicate"):FireServer({
			Goal = "LeftClick",
			Mobile = true
		})
	end)
end

local function stopSpamming()
	if spamConnection then
		spamConnection:Disconnect()
		spamConnection = nil
	end
	local char = player.Character
	if not char then return end
	char:WaitForChild("Communicate"):FireServer({
		Goal = "LeftClickRelease",
		Mobile = true
	})
end

-- Stick
local function stickToTarget()
	local char = player.Character
	if not char then return end
	local humanoidRootPart = char:WaitForChild("HumanoidRootPart")
	oldCFrame = humanoidRootPart.CFrame
	oldCameraType = camera.CameraType
	camera.CameraType = Enum.CameraType.Scriptable

	enableNoclip()
	startSpamming()

	-- Setup force
	velocity = Instance.new("BodyVelocity")
	velocity.MaxForce = Vector3.new(1e6, 1e6, 1e6)
	velocity.P = 10000
	velocity.Velocity = Vector3.zero
	velocity.Parent = humanoidRootPart

	gyro = Instance.new("BodyGyro")
	gyro.MaxTorque = Vector3.new(1e6, 1e6, 1e6)
	gyro.P = 5000
	gyro.CFrame = humanoidRootPart.CFrame
	gyro.Parent = humanoidRootPart

	connection = RunService.RenderStepped:Connect(function()
		if not stickOn then return end

		local hrp = char:FindFirstChild("HumanoidRootPart")
		if not hrp then return end

		if not target or not target.Character or not target.Character:FindFirstChild("HumanoidRootPart") or target.Character.Humanoid.Health <= 0 then
			target = findClosestPlayer()
		end

		if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
			local to = target.Character.HumanoidRootPart.Position
			local from = hrp.Position
			local followPos = to - Vector3.new(0, 7, 0)

			velocity.Velocity = (followPos - from) * 10
			gyro.CFrame = CFrame.new(from, followPos)

			local camOffset = Vector3.new(0, 14, 20)
			camera.CFrame = CFrame.new(to + camOffset, to)
		end
	end)
end

-- Unstick
local function unstick()
	if connection then connection:Disconnect() connection = nil end
	disableNoclip()
	stopSpamming()
	if velocity then velocity:Destroy() velocity = nil end
	if gyro then gyro:Destroy() gyro = nil end
	local char = player.Character
	if char and char:FindFirstChild("HumanoidRootPart") and oldCFrame then
		char.HumanoidRootPart.CFrame = oldCFrame
	end
	if oldCameraType then
		camera.CameraType = oldCameraType
	end
	target = nil
end

-- ✅ Toggle chuẩn dạng UI Library
local Toggle = Tab:CreateToggle({
	Name = "Auto Farm Near",
	CurrentValue = false,
	Flag = "StickToggle",
	Callback = function(Value)
		stickOn = Value
		if stickOn then
			stickToTarget()
		else
			unstick()
		end
	end,
})

local Tab = Window:CreateTab("", "menu")

local Section = Tab:CreateSection("Server")

local Button_Rejoin = Tab:CreateButton({
	Name = "Rejoin",
	Callback = function()
		local TeleportService = game:GetService("TeleportService")
		local player = game.Players.LocalPlayer

		local gui = Instance.new("ScreenGui")
		gui.Name = "RejoinGui"
		gui.ResetOnSpawn = false
		gui.Parent = player:WaitForChild("PlayerGui")

		local label = Instance.new("TextLabel")
		label.Size = UDim2.new(0.3, 0, 0.2, 0)
		label.Position = UDim2.new(0.35, 0, 0.4, 0)
		label.BackgroundTransparency = 1
		label.TextColor3 = Color3.new(1, 1, 1)
		label.Font = Enum.Font.GothamBold
		label.TextScaled = true
		label.Parent = gui

		for i = 5, 1, -1 do
			label.Text = "Rejoining in " .. i .. "..."
			task.wait(1)
		end

		gui:Destroy()
		TeleportService:Teleport(game.PlaceId, player)
	end,
})

local Button_ServerHop = Tab:CreateButton({
	Name = "Server Hop",
	Callback = function()
		local TeleportService = game:GetService("TeleportService")
		local HttpService = game:GetService("HttpService")
		local player = game.Players.LocalPlayer
		local placeId = game.PlaceId

		local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
		gui.Name = "ServerHopGui"
		gui.ResetOnSpawn = false

		local label = Instance.new("TextLabel", gui)
		label.Size = UDim2.new(0.3, 0, 0.2, 0)
		label.Position = UDim2.new(0.35, 0, 0.4, 0)
		label.BackgroundTransparency = 1
		label.TextColor3 = Color3.new(1, 1, 1)
		label.Font = Enum.Font.GothamBold
		label.TextScaled = true

		for i = 5, 1, -1 do
			label.Text = "Hopping in " .. i .. "..."
			task.wait(1)
		end

		gui:Destroy()

		local function getRandomServer()
			local servers = {}
			local success, result = pcall(function()
				return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..placeId.."/servers/Public?sortOrder=Asc&limit=100"))
			end)

			if success and result and result.data then
				for _, s in pairs(result.data) do
					if s.playing < s.maxPlayers and s.id ~= game.JobId then
						table.insert(servers, s.id)
					end
				end
			end

			return #servers > 0 and servers[math.random(1, #servers)] or nil
		end

		local target = getRandomServer()
		if target then
			TeleportService:TeleportToPlaceInstance(placeId, target, player)
		else
			warn("⚠️ Không tìm được server khác.")
		end
	end,
})

local Button_SmallServer = Tab:CreateButton({
	Name = "Small Server",
	Callback = function()
		local TeleportService = game:GetService("TeleportService")
		local HttpService = game:GetService("HttpService")
		local player = game.Players.LocalPlayer
		local placeId = game.PlaceId

		local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
		gui.Name = "SmallServerGui"
		gui.ResetOnSpawn = false

		local label = Instance.new("TextLabel", gui)
		label.Size = UDim2.new(0.3, 0, 0.2, 0)
		label.Position = UDim2.new(0.35, 0, 0.4, 0)
		label.BackgroundTransparency = 1
		label.TextColor3 = Color3.new(1, 1, 1)
		label.Font = Enum.Font.GothamBold
		label.TextScaled = true

		for i = 5, 1, -1 do
			label.Text = "Tìm server < 5 người trong " .. i .. "..."
			task.wait(1)
		end

		gui:Destroy()

		local function getSmallServer()
			local servers = {}
			local cursor = ""

			for i = 1, 5 do
				local url = "https://games.roblox.com/v1/games/"..placeId.."/servers/Public?sortOrder=Asc&limit=100"
				if cursor ~= "" then url = url .. "&cursor=" .. cursor end

				local success, data = pcall(function()
					return HttpService:JSONDecode(game:HttpGet(url))
				end)

				if success and data and data.data then
					for _, s in pairs(data.data) do
						if s.playing < 5 and s.id ~= game.JobId then
							table.insert(servers, s.id)
						end
					end

					if data.nextPageCursor then
						cursor = data.nextPageCursor
					else
						break
					end
				else
					break
				end
			end

			return #servers > 0 and servers[math.random(1, #servers)] or nil
		end

		local target = getSmallServer()
		if target then
			TeleportService:TeleportToPlaceInstance(placeId, target, player)
		else
			warn("⚠️ Không tìm được server < 5 người.")
		end
	end,
})

local Button_AntiLag = Tab:CreateButton({
	Name = "Anti Lag",
	Callback = function()
		loadstring(game:HttpGet("https://raw.githubusercontent.com/Kietba/Kietba/refs/heads/main/Antilag%20script"))()
	end,
})

local Button_CheckPing = Tab:CreateButton({
	Name = "Check Ping",
	Callback = function()
		local player = game:GetService("Players").LocalPlayer
		local screenGui = Instance.new("ScreenGui")
		screenGui.Name = "PingDisplay"
		screenGui.ResetOnSpawn = false
		screenGui.Parent = player:WaitForChild("PlayerGui")

		local pingLabel = Instance.new("TextLabel")
		pingLabel.Size = UDim2.new(0, 150, 0, 40)
		pingLabel.Position = UDim2.new(1, -160, 0, 10)
		pingLabel.BackgroundTransparency = 0.4
		pingLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
		pingLabel.TextColor3 = Color3.new(1, 1, 1)
		pingLabel.Font = Enum.Font.GothamBold
		pingLabel.TextSize = 20
		pingLabel.Text = "PING: -- ms"
		pingLabel.Parent = screenGui

		while true do
			local ping = math.floor(player:GetNetworkPing() * 1000)
			pingLabel.Text = "PING: " .. ping .. " ms"

			if ping <= 80 then
				pingLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
			elseif ping <= 150 then
				pingLabel.TextColor3 = Color3.fromRGB(255, 170, 0)
			else
				pingLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
			end

			wait(1)
		end
	end,
})

local Toggle_AntiAFK = Tab:CreateToggle({
	Name = "Anti Afk",
	CurrentValue = false,
	Flag = "AntiAFKToggle",
	Callback = function(Value)
		if Value then
			getgenv().AntiAFK_Connection = game:GetService("Players").LocalPlayer.Idled:Connect(function()
				local VirtualUser = game:GetService("VirtualUser")
				VirtualUser:Button2Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
				task.wait(1)
				VirtualUser:Button2Up(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
			end)
			warn("[✅ AntiAFK]: Enabled")
		else
			if getgenv().AntiAFK_Connection then
				getgenv().AntiAFK_Connection:Disconnect()
				getgenv().AntiAFK_Connection = nil
			end
			warn("[✅ AntiAFK]: Disabled")
		end
	end,
})

local Tab = Window:CreateTab("", "code")

local Section = Tab:CreateSection("Admin")

local Button = Tab:CreateButton({
   Name = "Infinite Yield",
   Callback = function()
   loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
   end,
})

local Button = Tab:CreateButton({
   Name = "Nameless",
   Callback = function()
   loadstring(game:HttpGet("https://github.com/FilteringEnabled/NamelessAdmin/blob/main/Source?raw=true"))()
   end,
})

local Tab = Window:CreateTab("", "settings")

local Section = Tab:CreateSection("Setting")

local Button = Tab:CreateButton({
   Name = "Destroy Gui",
   Callback = function()
   Rayfield:Destroy()
   end,
})
   warn("Game not support.")
end
